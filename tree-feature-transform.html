<!DOCTYPE html>
<html lang="cn">
<head>
        <meta charset="utf-8" />
        <title>tree feature transform</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">day one </a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/ji-qi-xue-xi.html">机器学习</a></li>
                    <li><a href="/category/ji-zhu.html">技术</a></li>
                    <li><a href="/category/sheng-huo.html">生活</a></li>
                    <li><a href="/category/tech.html">tech</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/tree-feature-transform.html" rel="bookmark"
           title="Permalink to tree feature transform">tree feature transform</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-11-19T00:00:00+08:00">
                Published: 三 19 十一月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/haoyuan-hu.html">haoyuan hu</a>
        </address>
<p>In <a href="/category/ji-qi-xue-xi.html">机器学习</a>.</p>

</footer><!-- /.post-info -->      <p>单纯的gbrt算法有较高的时间复杂度， 同时需要迭代获取最佳参数， 这方面lr更好。</p>
<p>但是， lr无法处理非线性的特征， 需要自己将非线性的特征映射为线性的特征。</p>
<p>所以， facebook采用了一种利用GBRT的叶子节点作为LR的输入特征的方式解决了这一问题。</p>
<p>paper：Practical Lessons from Predicting Clicks on Ads at Facebook.</p>
<h1>step 1</h1>
<p>使用GBRT进行训练， 利用grid search获得最佳参数。</p>
<h1>step 2</h1>
<p>对于GBRT的预测结果，首先对所有子树叶子节点编号，如果样本在第一棵子树落入2， 在第二棵子树落入4， 那么就输出[2, 4]，以此类推, 如果是稠密特征的话， 就是[0,1,0,1,0]。</p>
<p><img alt="" src="http://orange-tree.oss-cn-hangzhou.aliyuncs.com/blog-images/IMG_0378.JPG" /></p>
<h1>step 3</h1>
<p>将预测数据的结果做为输入的feature， 运行线性模型进行训练预测， 产生最终的预测结果。</p>
<h1>improvement</h1>
<p>一方面， 利用tree做feature transform可以消除correlation的影响， 另一方面以较低的代价获得了非线性的优势。</p>
<p>sample一部分数据进行GBRT训练还可以快速grid最佳参数。</p>
<h1>NEED</h1>
<p>完成基于lr数据格式的训练和预测模块， 完成上述的级联封装过程。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>